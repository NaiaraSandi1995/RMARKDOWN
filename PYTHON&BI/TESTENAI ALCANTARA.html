<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>50f77c23d7e0473c8840e297ebbf3e06</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="este-teste-ser√°-divido-em-duas-partes-ser√£o-avaliadas-no√ß√µes-de-neg√≥cios-no√ß√µes-de-sql-e-no√ß√µes-de-constru√ß√£o-de-dashboards" class="cell markdown" id="tPVbvbFtd4zM">
<h2>Este teste ser√° divido em duas partes. Ser√£o avaliadas no√ß√µes de neg√≥cios, no√ß√µes de SQL e no√ß√µes de constru√ß√£o de dashboards.</h2>
<p>Na primeira parte voc√™ responder√° perguntas sobre no√ß√µes de neg√≥cio. Em seguida responder√° perguntas relacionadas ao desenvolvimento de consultas SQL. E por fim voc√™ dever√° construir um dashboard que responda as perguntas de neg√≥cio e traga novos insigths sobre os dados apresentados.</p>
<p><strong>Voc√™ pode entregar at√© onde conseguir fazer o teste, at√© mesmo propor outras solu√ß√µes que achar necess√°rio. N√£o fique preso apenas ao que √© solicitado!</strong> üòÄ</p>
</section>
<section id="no√ß√µes-de-neg√≥cios" class="cell markdown" id="SzG0eyBKRLtD">
<h2>No√ß√µes de Neg√≥cios</h2>
<p>Aqui vamos avaliar quest√µes do dia a dia, sobre como lidar com a equipe e o cliente.</p>
</section>
<div class="cell markdown" id="kgs8DNihI7Lx">
<ol>
<li>Voc√™ √© designado para um cliente com o objetivo de desenvolver um dashboard para a equipe Comercial. Voc√™ nunca trabalhou com este cliente e n√£o tem contexto dos dados. Quais seriam seus passos para o desenvolvimento do trabalho?</li>
</ol>
</div>
<div class="cell markdown" id="pbQhIo2tePOc">
<p>Para come√ßar eu faria uma reuni√£o de kickoff com nosso setor comercial (que vendeu o projeto) para entender a ideia inicial.</p>
<p>Depois faria a reuni√£o de briefing com o cliente, pois √© importante entender quais s√£o os objetivos que o conduziram a fazer pesquisa, o que ele espera entender, quais s√£o seu objetivos, dentre outros.<br />
Ap√≥s essa reuni√£o, eu estaria munida com as seguintes informa√ß√µes:</p>
<p>1-Teria uma ideia de como funciona a empresa (seu ramo de neg√≥cio, quem s√£o seus clientes e etc).<br />
2-Poderia baixar ou solicitar a paleta de cores da empresa, logos e maneiras de utiliza√ß√£o visual da marca 3-Objetivos da pesquisa, ent√£o conseguiria j√° criar os insights, a partir dos dados</p>
<p>Diante disso eu daria o start no desenvolvimento do Dash. Primeiro organizaria os dados, depois pensaria em quais gr√°ficos e ideias s√£o mais interessantes para cada uma das p√°ginas do BI, e iria fazendo no "Dasktop" e testando na vers√£o "Servi√ßo".</p>
<p>Quando estivesse pronto e revisado, mandaria o link para a revis√£o do meu superior, para cr√≠ticas, corre√ß√µes, altera√ß√µes, opini√µes, enfim o que fosse cab√≠vel. Feitas todas as etapas do desenvolmento desse trabalho, o produto estaria pronto para ser entregue atrav√©s de uma apresenta√ß√£o para o cliente.</p>
</div>
<div class="cell markdown" id="TaKnEu8dd7fa">
<ol>
<li>Como voc√™ tra√ßaria um processo de valida√ß√£o de dados e consistencia das regras de neg√≥cio implementadas?</li>
</ol>
</div>
<div class="cell markdown" id="TrnFgjxxRe5e">
<p>A valida√ß√£o dos dados seria feita atrav√©s da verifica√ß√£o das l√≥gicas do question√°rios. Identificaria todas as quest√µes n√£o obrigat√≥rias com l√≥gicas.</p>
<p>Por exemplo, "Qual o n√∫mero do seu sapato" essa pergunta somente poderia ser respondida por mulheres que cal√ßassem &lt;=38, ent√£o inseriria exatamente essa regra na quest√£o. Se houvesse uma c√©lula respondida referente a um homem, ent√£o teria uma incosist√™nica e a resposta deveria ser exclu√≠da, pois homens n√£o deveriam ter respondido. Se quem respondeu fosse uma mulher que cal√ßa 40, ent√£o esse n√∫mero tamb√©mm deveria ser apagado.</p>
<p>Esse √© um tipo de consist√™ncia que deveria ser feito na base de dados para valid√°-la. J√° em rela√ß√£o as regras de neg√≥cio a serem implementadas pela empresa, tendo validado os dados, os valores indicar√£o quais s√£o as melhores estrat√©gias a serem implementadas.</p>
<p>Por exemplo, se fosse uma pesquisa sobre o consumo de maquiagem de uma empresa X, cujo universo fossem suas clientes e os dados demonstrassem que:</p>
<p>(1) A maioria das mulheres esta satisfeita com a qualidade dos protudos, (2)tem a pretens√£o de continuar comprando, isto √©, ir√° se manter fiel e (3) dizem que se houver a cria√ß√£o de uma nova linha, continuariam comprando ainda que seja um pouco mais cara, pois acreditam que os produtos ser√£o mais modernos. Veja, estamos falando sempre da maioria (mais do que 50% das/os entrevidas/os), sendo assim, √© claramente recomendado que a empresa mantenha sua produ√ß√£o habital, suas regras de neg√≥cio, mas tamb√©m pode lan√ßar essa nova linha mais custosa, pois haver√° boa receptividade por parte de suas clientes.</p>
</div>
<section id="teste-pr√°tico-de-linguagem-de-consulta-estruturada-sql" class="cell markdown" id="ls0vTQwK0C6z">
<h1>TESTE PR√ÅTICO DE LINGUAGEM DE CONSULTA ESTRUTURADA (SQL)</h1>
<p>Para a realiza√ß√£o das atividades, voc√™ dever√° executar as instru√ß√µes abaixo para importar as bibliotecas e fun√ß√µes necess√°rias para criar a base de dados.</p>
<p>Ao final, esperamos que voc√™ desenvolva os c√≥digos selecionados e entregue o notebook com as consultas SQL desenvolvidas e o arquivo .db criado.</p>
<p>O teste importar√° tr√™s arquivos cruciais para o desenvolvimento dessa atividade. Todos est√£o no Githun (n√£o mude as URL's).</p>
<ul>
<li>usuarios.csv</li>
<li>produtos.csv</li>
<li>vendas.csv</li>
</ul>
<h2 id="o-teste-foi-desenvolvido-para-ser-executado-com-o-sqlite3-e-no-google-colab-ubuntu-1804-voc√™-dever√°-utilizar-consultas-no-padr√£o-ansi-os-comandos-necess√°rios-podem-ser-encontrados-em">O teste foi desenvolvido para ser executado com o SQLite3 e no Google Colab (Ubuntu 18.04). Voc√™ dever√° utilizar consultas no padr√£o ANSI. Os comandos necess√°rios podem ser encontrados em:</h2>
<p><a href="https://www.sqlite.org/docs.html" class="uri">https://www.sqlite.org/docs.html</a></p>
<p><a href="https://www.tutorialspoint.com/sqlite/index.htm" class="uri">https://www.tutorialspoint.com/sqlite/index.htm</a></p>
</section>
<section id="aviso" class="cell markdown" id="bSjsGmXsuYqZ">
<h1>AVISO!</h1>
<ol>
<li>Execute o c√≥digo abaixo para atualizar a biblioteca do SQLite3 utilizada para essa atividade</li>
<li><strong>Ignore as mensagens de erro sobre perda de conectividade na instru√ß√£o abaixo (o kernel ser√° reiniciado para atualiza√ß√£o do SQLite3)</strong></li>
</ol>
</section>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="1TZeXvCkWawk" data-outputId="362589e7-51a8-4510-a3f2-9aec9bb808cc">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># BAIXAR A √öLTIMA RELEASE DO COLAB, DESCOMPACTAR E INSTALAR NO DIRET√ìRIO DO </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PYTHON 3.7 (VERS√ÉO USADA PELO COLAB NESSE NOTEBOOK)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>curl https:<span class="op">//</span>www.sqlite.org<span class="op">/</span>src<span class="op">/</span>tarball<span class="op">/</span>sqlite.tar.gz?r<span class="op">=</span>release <span class="op">|</span> tar xz</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd sqlite<span class="op">/</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>.<span class="op">/</span>configure</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>make sqlite3.c</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd <span class="op">/</span>content<span class="op">/</span>sqlite<span class="op">/</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>npx degit coleifer<span class="op">/</span>pysqlite3 <span class="op">-</span>f</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp sqlite<span class="op">/</span>sqlite3.[ch] .</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python setup.py build_static build</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp build<span class="op">/</span>lib.linux<span class="op">-</span>x86_64<span class="op">-</span><span class="fl">3.7</span><span class="op">/</span>pysqlite3<span class="op">/</span>_sqlite3.cpython<span class="op">-</span><span class="dv">37</span>m<span class="op">-</span>x86_64<span class="op">-</span>linux<span class="op">-</span>gnu.so <span class="op">\</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>     <span class="op">/</span>usr<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.7</span><span class="op">/</span>lib<span class="op">-</span>dynload<span class="op">/</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># REINICIANDO O KERNEL DO COLAB PARA IMPORTAR A BIBLIOTECA ATUALIZADA</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>os.kill(os.getpid(), <span class="dv">9</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 11.5M  100 11.5M    0     0  9580k      0  0:00:01  0:00:01 --:--:-- 9580k
/content/sqlite
checking build system type... x86_64-pc-linux-gnu
checking host system type... x86_64-pc-linux-gnu
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking for a sed that does not truncate output... /bin/sed
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for fgrep... /bin/grep -F
checking for ld used by gcc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 1572864
checking whether the shell understands some XSI constructs... yes
checking whether the shell understands &quot;+=&quot;... yes
checking for /usr/bin/ld option to reload object files... -r
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for ar... ar
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /usr/bin/nm -B output from gcc object... ok
./configure: line 5197: /usr/bin/file: No such file or directory
checking how to run the C preprocessor... gcc -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for dlfcn.h... yes
checking for objdir... .libs
checking if gcc supports -fno-rtti -fno-exceptions... no
checking for gcc option to produce PIC... -fPIC -DPIC
checking if gcc PIC flag -fPIC -DPIC works... yes
checking if gcc static flag -static works... yes
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (/usr/bin/ld) supports shared libraries... yes
checking whether -lc should be explicitly linked in... no
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
checking for a BSD-compatible install... /usr/bin/install -c
checking for special C compiler options needed for large files... no
checking for _FILE_OFFSET_BITS value needed for large files... no
checking for int8_t... yes
checking for int16_t... yes
checking for int32_t... yes
checking for int64_t... yes
checking for intptr_t... yes
checking for uint8_t... yes
checking for uint16_t... yes
checking for uint32_t... yes
checking for uint64_t... yes
checking for uintptr_t... yes
checking for sys/types.h... (cached) yes
checking for stdlib.h... (cached) yes
checking for stdint.h... (cached) yes
checking for inttypes.h... (cached) yes
checking malloc.h usability... yes
checking malloc.h presence... yes
checking for malloc.h... yes
checking for fdatasync... yes
checking for gmtime_r... yes
checking for isnan... yes
checking for localtime_r... yes
checking for localtime_s... no
checking for malloc_usable_size... yes
checking for strchrnul... yes
checking for usleep... yes
checking for utime... yes
checking for pread... yes
checking for pread64... yes
checking for pwrite... yes
checking for pwrite64... yes
checking for tclsh8.7... no
checking for tclsh8.6... tclsh8.6
configure: Version set to 3.40
configure: Release set to 3.40.0
checking whether to support threadsafe operation... yes
checking for library containing pthread_create... -lpthread
checking for library containing pthread_mutexattr_init... none required
checking whether to support shared library linked as release mode or not... no
checking whether to use an in-ram database for temporary tables... no
checking if executables have the .exe suffix... unknown
checking for Tcl configuration... found /usr/lib/tclConfig.sh
checking for existence of /usr/lib/tclConfig.sh... loading
checking for library containing readline... no
checking for library containing tgetent... -lncurses
checking for readline in -lreadline... yes
checking readline.h usability... no
checking readline.h presence... no
checking for readline.h... no
checking for /usr/include/readline.h... no
checking for /usr/include/readline/readline.h... yes
checking for library containing fdatasync... none required
checking build type... release
checking zlib.h usability... yes
checking zlib.h presence... yes
checking for zlib.h... yes
checking for library containing deflate... -lz
checking for library containing dlopen... -ldl
checking whether to support math functions... yes
checking for library containing ceil... -lm
checking whether to support JSON functions... yes
checking whether to support MEMSYS5... no
checking whether to support MEMSYS3... no
checking whether to support FTS3... no
checking whether to support FTS4... no
checking whether to support FTS5... no
checking whether to support LIMIT on UPDATE and DELETE statements... no
checking whether to support GEOPOLY... no
checking whether to support RTREE... no
checking whether to support SESSION... no
configure: creating ./config.status
config.status: creating Makefile
config.status: creating sqlite3.pc
config.status: creating sqlite_cfg.h
config.status: sqlite_cfg.h is unchanged
config.status: executing libtool commands
make: &#39;sqlite3.c&#39; is up to date.
/content/sqlite
&gt; destination directory is not empty. Using --force, continuing
&gt; cloned coleifer/pysqlite3#HEAD
cp: cannot stat &#39;sqlite/sqlite3.[ch]&#39;: No such file or directory
running build_static
Builds a C extension using a sqlite3 amalgamation
running build
running build_py
running build_ext
Builds a C extension linking against libsqlite3 library
</code></pre>
</div>
</div>
<section id="instru√ß√µes-para-realizar-as-consultas" class="cell markdown" id="YD9I0i8qRVCo">
<h1>INSTRU√á√ïES PARA REALIZAR AS CONSULTAS</h1>
<h3 id="para-consultar-dados-siga-os-passos-abaixo">PARA CONSULTAR DADOS, SIGA OS PASSOS ABAIXO:</h3>
<h4 id="abrir-conex√£o">Abrir conex√£o:</h4>
<pre><code>conexao_sql = sqlite3.connect(banco)</code></pre>
<h4 id="abrir-cursor-para-executar-consulta-no-banco">Abrir cursor para executar consulta no banco:</h4>
<pre><code>cursor = conexao_sql.cursor()</code></pre>
<h4 id="criar-uma-consulta">Criar uma consulta:</h4>
<pre><code>consulta = &#39;&#39;&#39;
    Coloque aqui a sua instru√ß√£o SQL;
&#39;&#39;&#39;
cursor.execute(consulta)</code></pre>
<h4 id="para-visualizar-o-resultado-da-sua-consulta">Para visualizar o resultado da sua consulta:</h4>
<pre><code>for linha in cursor:
  print(linha)</code></pre>
<h4 id="para-fechar-a-conex√£o">Para fechar a conex√£o:</h4>
<pre><code>conexao_sql.close()</code></pre>
<h3 id="lembre-se-de-que-python-√©-sens√≠vel-a-identa√ß√£o-de-c√≥digo">LEMBRE-SE DE QUE PYTHON √â SENS√çVEL A IDENTA√á√ÉO DE C√ìDIGO!</h3>
</section>
<section id="importando-bibliotecas-necess√°rias-para-executar-os-c√≥digos-em-sql" class="cell markdown" id="Q-JtQam4AsEU">
<h1>IMPORTANDO BIBLIOTECAS NECESS√ÅRIAS PARA EXECUTAR OS C√ìDIGOS EM SQL</h1>
</section>
<div class="cell code" data-execution_count="1" id="0CBwbpEfAl5m">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.parse <span class="im">import</span> urlparse</span></code></pre></div>
</div>
<section id="defini√ß√£o-de-vari√°veis-fixas-para-o-projeto" class="cell markdown" id="-pbN5gB4MsUO">
<h1>DEFINI√á√ÉO DE VARI√ÅVEIS FIXAS PARA O PROJETO</h1>
</section>
<div class="cell code" data-execution_count="2" id="MExXbyvGMvoE">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>banco <span class="op">=</span> <span class="st">&quot;teste_sql.db&quot;</span></span></code></pre></div>
</div>
<section id="fun√ß√£o-para-inserir-registros-no-banco-de-dados" class="cell markdown" id="REYwFNTZ5u93">
<h1>FUN√á√ÉO PARA INSERIR REGISTROS NO BANCO DE DADOS</h1>
</section>
<div class="cell code" data-execution_count="3" id="-ocVcmyN5uHv">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recebe como par√¢metro</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Nome do banco de dados</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Nome da tabela que receber√° os dados</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Lista das colunas da tabela</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Dados que ser√£o inseridos</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> inserir_registros(banco, tabela, lista_colunas, arquivo):</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  conexao_sql <span class="op">=</span> sqlite3.<span class="ex">connect</span>(banco)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  cursor <span class="op">=</span> conexao_sql.cursor()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  dados <span class="op">=</span> <span class="bu">open</span>(arquivo)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  conteudo_dados <span class="op">=</span> csv.reader(dados)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  num_colunas <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> lista_colunas.count(<span class="st">&#39;,&#39;</span>) <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> lista_colunas.count(<span class="st">&#39;,&#39;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  string_insert <span class="op">=</span> <span class="st">&#39;INSERT INTO &#39;</span> <span class="op">+</span> tabela <span class="op">+</span> <span class="st">&#39; (&#39;</span> <span class="op">+</span> lista_colunas <span class="op">+</span> <span class="st">&#39;) VALUES (?&#39;</span> <span class="op">+</span> (<span class="st">&#39;&#39;</span> <span class="cf">if</span> num_colunas <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">&#39;, ?&#39;</span> <span class="op">*</span> (num_colunas)) <span class="op">+</span> <span class="st">&#39;)&#39;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  cursor.executemany(string_insert, conteudo_dados)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  conexao_sql.commit()</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  conexao_sql.close()</span></code></pre></div>
</div>
<section id="fun√ß√£o-para-baixar-a-base-de-dados-utilizada-para-desenvolvimento-das-atividades" class="cell markdown" id="8ZhCn-s-zofx">
<h1>FUN√á√ÉO PARA BAIXAR A BASE DE DADOS UTILIZADA PARA DESENVOLVIMENTO DAS ATIVIDADES</h1>
</section>
<div class="cell code" data-execution_count="4" id="jniWnEiPzsoR">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recebe como par√¢metro:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Nome do arquivo com a extens√£o (Ex: base.csv)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. URL do site onde o dado est√° localizado (Ex: &#39;https://drive.google.com/user_teste/folder_dataset/file.csv&#39;):</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> baixar_dados(nome_arquivo, url):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  requisicao <span class="op">=</span> requests.get(url)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  conteudo <span class="op">=</span> requisicao.content</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  arquivo_csv <span class="op">=</span> <span class="bu">open</span>(nome_arquivo, <span class="st">&#39;wb&#39;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  arquivo_csv.write(conteudo)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  arquivo_csv.close()</span></code></pre></div>
</div>
<section id="cria√ß√£o-de-conex√£o-com-o-banco-sqlite3-para-desenvolvimento-da-atividade" class="cell markdown" id="ZDzP63LXB-Yb">
<h1>CRIA√á√ÉO DE CONEX√ÉO COM O BANCO SQLITE3 PARA DESENVOLVIMENTO DA ATIVIDADE</h1>
</section>
<div class="cell code" data-execution_count="5" id="3XY-opKGB-Fc">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Abre conex√£o com o banco. Se o arquivo n√£o existir, cria a base.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>conexao_sql <span class="op">=</span> sqlite3.<span class="ex">connect</span>(banco)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>conexao_sql.close()</span></code></pre></div>
</div>
<section id="cria√ß√£o-das-tabelas-para-realiza√ß√£o-das-atividades" class="cell markdown" id="HnUMa9XnCcKb">
<h1>CRIA√á√ÉO DAS TABELAS PARA REALIZA√á√ÉO DAS ATIVIDADES</h1>
</section>
<section id="tabela-de-usu√°rios" class="cell markdown" id="YuyEsU8WAZZm">
<h3>TABELA DE USU√ÅRIOS</h3>
</section>
<div class="cell code" data-execution_count="6" id="GrzK24ITCS-O">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/A3Data/testes_praticos/main/sql/base_dados/usuarios.csv&#39;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>nome_arquivo <span class="op">=</span> Path(urlparse(url).path).name</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>baixar_dados(nome_arquivo, url)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>conexao_sql <span class="op">=</span> sqlite3.<span class="ex">connect</span>(banco)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># CRIAR A TABELA</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>conexao_sql.execute(<span class="st">&#39;&#39;&#39;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE TABLE IF NOT EXISTS usuarios</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st">(</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="st">  cod_usuario INTEGER NOT NULL,</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="st">  data_cadastro DATE NOT NULL,</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="st">  faixa_etaria TEXT,</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="st">  cidade TEXT NOT NULL,</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="st">  estado TEXT NOT NULL);&#39;&#39;&#39;</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>conexao_sql.commit()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># INSERIR OS REGISTROS NO BANCO DE DADOS</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>lista_campos <span class="op">=</span> <span class="st">&#39;cod_usuario, data_cadastro, faixa_etaria, cidade, estado&#39;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>inserir_registros(banco, <span class="st">&#39;usuarios&#39;</span>, lista_campos, nome_arquivo)</span></code></pre></div>
</div>
<section id="tabela-de-produtos" class="cell markdown" id="DoMfz7RxJQzZ">
<h3>TABELA DE PRODUTOS</h3>
</section>
<div class="cell code" data-execution_count="7" id="qgL8Rka-JTPI">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/A3Data/testes_praticos/main/sql/base_dados/produtos.csv&#39;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>nome_arquivo <span class="op">=</span> Path(urlparse(url).path).name</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>baixar_dados(nome_arquivo, url)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>conexao_sql <span class="op">=</span> sqlite3.<span class="ex">connect</span>(banco)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>arquivo_produtos <span class="op">=</span> <span class="st">&#39;produtos.csv&#39;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># CRIAR A TABELA</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>conexao_sql.execute(<span class="st">&#39;&#39;&#39;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE TABLE IF NOT EXISTS produtos</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="st">(</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="st">  cod_produto INTEGER NOT NULL,</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="st">  nome_produto TEXT NOT NULL,</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="st">  categoria_produto TEXT,</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="st">  valor_produto FLOAT);&#39;&#39;&#39;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>conexao_sql.commit()</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># INSERIR OS REGISTROS NO BANCO DE DADOS</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>lista_campos <span class="op">=</span> <span class="st">&#39;cod_produto, nome_produto, categoria_produto, valor_produto&#39;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>inserir_registros(banco, <span class="st">&#39;produtos&#39;</span>, lista_campos, arquivo_produtos)</span></code></pre></div>
</div>
<section id="tabela-de-vendas" class="cell markdown" id="Hgyf94onJxDN">
<h3>TABELA DE VENDAS</h3>
</section>
<div class="cell code" data-execution_count="8" id="8Wb1heaCNukB">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/A3Data/testes_praticos/main/sql/base_dados/vendas.csv&#39;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>nome_arquivo <span class="op">=</span> Path(urlparse(url).path).name</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>baixar_dados(nome_arquivo, url)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>conexao_sql <span class="op">=</span> sqlite3.<span class="ex">connect</span>(banco)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>arquivo_vendas <span class="op">=</span> <span class="st">&#39;vendas.csv&#39;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># CRIAR A TABELA</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>conexao_sql.execute(<span class="st">&#39;&#39;&#39;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE TABLE IF NOT EXISTS vendas</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">(</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="st">  cod_usuario INTEGER NOT NULL,</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="st">  cod_produto INTEGER NOT NULL,</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="st">  data_compra DATE NOT NULL,</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="st">  quantidade INT NOT NULL,</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="st">  valor FLOAT NOT NULL);&#39;&#39;&#39;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>conexao_sql.commit()</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># INSERIR OS REGISTROS NO BANCO DE DADOS</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>lista_campos <span class="op">=</span> <span class="st">&#39;cod_usuario, cod_produto, data_compra, quantidade, valor&#39;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>inserir_registros(banco, <span class="st">&#39;vendas&#39;</span>, lista_campos, arquivo_vendas)</span></code></pre></div>
</div>
<section id="pergunta-1" class="cell markdown" id="nRJNYDRWTgiL">
<h2>Pergunta 1:</h2>
<p>Escreva um comando em SQL que retorne a quantidade de venda do estado de Minas Gerais por ano e m√™s</p>
</section>
<div class="cell code" data-execution_count="9" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ed_t8KnbRVz2" data-outputId="2da28e51-70f1-46bc-af75-8aa53e41938e">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlite3.dbapi2 <span class="im">import</span> SQLITE_SELECT</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> conexao_sql.cursor()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>consulta <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT strftime(&#39;%Y-%m&#39;,data_compra) as data,</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="st">  sum(quantidade) </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM vendas </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE cod_usuario IN (SELECT cod_usuario FROM usuarios WHERE estado like &quot;Minas Gerais&quot;)</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY data</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>cursor.execute(consulta)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> linha <span class="kw">in</span> cursor:</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(linha)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(&#39;2018-06&#39;, 10)
(&#39;2018-08&#39;, 16)
(&#39;2018-10&#39;, 20)
(&#39;2018-11&#39;, 10)
(&#39;2018-12&#39;, 39)
(&#39;2019-01&#39;, 20)
(&#39;2019-02&#39;, 2)
(&#39;2019-04&#39;, 26)
(&#39;2019-05&#39;, 11)
(&#39;2019-06&#39;, 1)
(&#39;2019-07&#39;, 14)
(&#39;2019-08&#39;, 15)
(&#39;2019-09&#39;, 27)
(&#39;2019-10&#39;, 3)
(&#39;2019-11&#39;, 1)
(&#39;2019-12&#39;, 25)
(&#39;2020-01&#39;, 8)
(&#39;2020-02&#39;, 10)
(&#39;2020-03&#39;, 14)
(&#39;2020-04&#39;, 1)
(&#39;2020-05&#39;, 44)
(&#39;2020-06&#39;, 18)
(&#39;2020-07&#39;, 30)
(&#39;2020-09&#39;, 44)
(&#39;2020-10&#39;, 8)
(&#39;2020-11&#39;, 43)
(&#39;2020-12&#39;, 18)
(&#39;2021-01&#39;, 21)
(&#39;2021-02&#39;, 75)
(&#39;2021-03&#39;, 6)
(&#39;2021-04&#39;, 58)
(&#39;2021-05&#39;, 22)
(&#39;2021-06&#39;, 16)
(&#39;2021-07&#39;, 61)
</code></pre>
</div>
</div>
<section id="pergunta-2" class="cell markdown" id="dJdjxIQSUMwC">
<h2>Pergunta 2:</h2>
<p>Escreva um comando em SQL que retorne quais s√£o os 3 produtos mais comprados por estado, a quantidade de itens comprados, o valor total pago e a m√©dia de pre√ßo paga</p>
</section>
<div class="cell code" data-execution_count="12" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="eayXzmJkfvzj" data-outputId="c723d08f-2c79-446c-ab37-a5249eacadb9">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlite3.dbapi2 <span class="im">import</span> SQLITE_SELECT</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> conexao_sql.cursor()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>consulta <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT produtos.nome_produto, sum(vendas.quantidade), sum(vendas.valor), avg(vendas.valor), usuarios.estado</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">FROM vendas, produtos, usuarios</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE vendas.cod_usuario = usuarios.cod_usuario </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY usuarios.estado</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>cursor.execute(consulta)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> linha <span class="kw">in</span> cursor:</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(linha)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(&#39;Notebook Asus Intel Core i7&#39;, 1281, 1078546.1399999992, 7337.048571428566, &#39;Amap√°&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 6111, 5064958.29, 7093.779117647059, &#39;Bahia&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 1659, 2551388.07, 15186.83375, &#39;Cear√°&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 5250, 10149045.480000028, 19331.515200000053, &#39;Goi√°s&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 5901, 4730530.769999983, 8045.120357142828, &#39;Maranh√£o&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 3948, 3805174.800000014, 11324.925000000041, &#39;Mato Grosso&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 2562, 3575669.1599999988, 18918.884444444437, &#39;Mato Grosso do Sul&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 15477, 14975799.30000004, 10187.618571428598, &#39;Minas Gerais&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 5880, 5235860.490000037, 9234.321851851917, &#39;Paran√°&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 2604, 2693161.800000009, 14249.533333333382, &#39;Para√≠ba&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 2940, 3626189.7000000062, 12333.978571428592, &#39;Pernambuco&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 2310, 3798136.860000005, 18086.366000000024, &#39;Piau√≠&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 4536, 7547855.069999986, 19967.87055555552, &#39;Rio Grande do Norte&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 6762, 4644135.089999985, 5819.718157894718, &#39;Rio Grande do Sul&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 7917, 10861528.440000031, 12615.015609756134, &#39;Santa Catarina&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 7518, 8890678.020000042, 11141.200526315843, &#39;S√£o Paulo&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 1995, 2308717.319999998, 9994.447272727264, &#39;Tocantins&#39;)
</code></pre>
</div>
</div>
<section id="pergunta-3" class="cell markdown" id="Hs2o1EJphVrF">
<h2>Pergunta 3</h2>
<p>Escreva um comando em SQL que retorne o produto, a quantidade de itens vendidos e a receita do produto que tem mais itens vendidos por ano e m√™s</p>
</section>
<div class="cell code" data-execution_count="13" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="SrjlUYY_K6r5" data-outputId="71da82b6-134d-4d5c-d1f8-cad3db4d6d83">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlite3.dbapi2 <span class="im">import</span> SQLITE_SELECT</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> conexao_sql.cursor()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>consulta <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT produtos.nome_produto, vendas.quantidade, vendas.quantidade * valor_produto, </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="st">strftime(&#39;%Y&#39;,vendas.data_compra) as data1, strftime(&#39;%m&#39;,vendas.data_compra) as data2</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM vendas, produtos</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE vendas.cod_produto = produtos.cod_produto</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY data1, data2</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="st">  HAVING vendas.quantidade = max(vendas.quantidade)</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>cursor.execute(consulta) </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> linha <span class="kw">in</span> cursor:</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(linha)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(&#39;Smartphone Samsung&#39;, 17, 34841.5, &#39;2018&#39;, &#39;01&#39;)
(&#39;Jogo Mortal Kombat 11 PS4&#39;, 19, 948.1, &#39;2018&#39;, &#39;02&#39;)
(&#39;Microoondas 35L&#39;, 20, 7782.0, &#39;2018&#39;, &#39;03&#39;)
(&#39;Monitor LG 19 pol curvado&#39;, 20, 11682.0, &#39;2018&#39;, &#39;04&#39;)
(&#39;Escrivaninha em L&#39;, 19, 8303.0, &#39;2018&#39;, &#39;05&#39;)
(&#39;Monitor LG 19 pol curvado&#39;, 20, 11682.0, &#39;2018&#39;, &#39;06&#39;)
(&#39;Cadeira Gamer Xpress&#39;, 20, 13998.0, &#39;2018&#39;, &#39;07&#39;)
(&#39;Alcool em Gel 70% Johnson&#39;, 20, 99.80000000000001, &#39;2018&#39;, &#39;08&#39;)
(&#39;Microoondas 35L&#39;, 20, 7782.0, &#39;2018&#39;, &#39;09&#39;)
(&#39;Biscoito Chocolicia Chocolate&#39;, 20, 100.0, &#39;2018&#39;, &#39;10&#39;)
(&#39;Umidificador de Ar Cadence&#39;, 20, 1550.0, &#39;2018&#39;, &#39;11&#39;)
(&#39;Mochila Targus&#39;, 20, 1178.0, &#39;2018&#39;, &#39;12&#39;)
(&#39;SmartTV Samsung 4K 55 polegadas&#39;, 20, 49998.0, &#39;2019&#39;, &#39;01&#39;)
(&#39;Smartphone Samsung&#39;, 20, 40990.0, &#39;2019&#39;, &#39;02&#39;)
(&#39;Sofa 3 lugares&#39;, 20, 17998.0, &#39;2019&#39;, &#39;03&#39;)
(&#39;Mochila Targus&#39;, 20, 1178.0, &#39;2019&#39;, &#39;04&#39;)
(&#39;Smartphone Samsung&#39;, 20, 40990.0, &#39;2019&#39;, &#39;05&#39;)
(&#39;Len√ßo umedecido Turma da Monica&#39;, 20, 158.0, &#39;2019&#39;, &#39;06&#39;)
(&#39;Cafeteira Nespresso&#39;, 20, 4391.4, &#39;2019&#39;, &#39;07&#39;)
(&#39;Len√ßo umedecido Turma da Monica&#39;, 20, 158.0, &#39;2019&#39;, &#39;08&#39;)
(&#39;SmartTV Samsung 4K 55 polegadas&#39;, 20, 49998.0, &#39;2019&#39;, &#39;09&#39;)
(&#39;Kit 3 barras de chocolate Alpino&#39;, 20, 198.0, &#39;2019&#39;, &#39;10&#39;)
(&#39;Escrivaninha em L&#39;, 20, 8740.0, &#39;2019&#39;, &#39;11&#39;)
(&#39;SmartTV Samsung 4K 55 polegadas&#39;, 20, 49998.0, &#39;2019&#39;, &#39;12&#39;)
(&#39;Bicicleta Caloi Aro 29&#39;, 20, 26915.6, &#39;2020&#39;, &#39;01&#39;)
(&#39;SmartTV Samsung 4K 55 polegadas&#39;, 20, 49998.0, &#39;2020&#39;, &#39;02&#39;)
(&#39;Sofa 3 lugares&#39;, 20, 17998.0, &#39;2020&#39;, &#39;03&#39;)
(&#39;Sofa 3 lugares&#39;, 20, 17998.0, &#39;2020&#39;, &#39;04&#39;)
(&#39;Kit 3 barras de chocolate Alpino&#39;, 20, 198.0, &#39;2020&#39;, &#39;05&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 20, 91818.0, &#39;2020&#39;, &#39;06&#39;)
(&#39;Umidificador de Ar Cadence&#39;, 20, 1550.0, &#39;2020&#39;, &#39;07&#39;)
(&#39;Smartphone Samsung&#39;, 20, 40990.0, &#39;2020&#39;, &#39;08&#39;)
(&#39;Bicicleta Caloi Aro 29&#39;, 20, 26915.6, &#39;2020&#39;, &#39;09&#39;)
(&#39;Blusa Lacoste&#39;, 20, 2779.8, &#39;2020&#39;, &#39;10&#39;)
(&#39;Umidificador de Ar Cadence&#39;, 20, 1550.0, &#39;2020&#39;, &#39;11&#39;)
(&#39;Biscoito Chocolicia Chocolate&#39;, 20, 100.0, &#39;2020&#39;, &#39;12&#39;)
(&#39;Aparelho de Barbear OneBlade Philco&#39;, 20, 2598.0, &#39;2021&#39;, &#39;01&#39;)
(&#39;Cafeteira Nespresso&#39;, 20, 4391.4, &#39;2021&#39;, &#39;02&#39;)
(&#39;Alcool em Gel 70% Johnson&#39;, 20, 99.80000000000001, &#39;2021&#39;, &#39;03&#39;)
(&#39;Len√ßo umedecido Turma da Monica&#39;, 20, 158.0, &#39;2021&#39;, &#39;04&#39;)
(&#39;Notebook Asus Intel Core i7&#39;, 20, 91818.0, &#39;2021&#39;, &#39;05&#39;)
(&#39;SPA Intel 700 L&#39;, 20, 119982.0, &#39;2021&#39;, &#39;06&#39;)
(&#39;Blusa Lacoste&#39;, 20, 2779.8, &#39;2021&#39;, &#39;07&#39;)
</code></pre>
</div>
</div>
<section id="constru√ß√£o-de-dashboard" class="cell markdown" id="jkZjZ32lmPH2">
<h1><strong>Constru√ß√£o de dashboard</strong></h1>
<p><strong>Seu desafio √© desenvolver uma an√°lise dos dados de vendas disponibilizados pela Data Coporation, com o intuito de gerar insights para os gestores respons√°veis.</strong></p>
<p>O dashboard dever√° conter apenas uma p√°gina e ser desenvolvido em Power BI.</p>
<p>Segue algumas perguntas feitas pelos gestores que devem ser abordadas:</p>
<ol>
<li><p>O gerente geral da Data Corporation decidiu abrir opera√ß√£o de lojas fisicas em quatro cidades. Quais cidades voc√™ indicaria baseado no hist√≥rico de compras?</p></li>
<li><p>Para abrir a opera√ß√£o de lojas fisicas o gerante tamb√©m precisa decidir qual categoria ele deve investir, pensando em retorno financeiro. Al√©m disso ele gostaria de indica√ß√µes de produtos que possam alanvancar as vendas nos primeiros 6 meses. A proposta √© que a abertura aconte√ßa nos meses de janeiro e fevereiro. Qual seria sua indica√ß√£o?</p></li>
</ol>
<p><strong>N√£o fique preso nas perguntas acima, novos insights s√£o sempre bem vindos!</strong></p>
<p>LINK PARA ACESSAR O POWER BI DA NAIARA: <a href="https://app.powerbi.com/view?r=eyJrIjoiNDc1ZjlkMGYtZWM3OC00MzQ4LTk1MmQtMzAxMDFkNDMwMDNlIiwidCI6IjM3MWYxZjdjLTA4OTQtNDFkMi04M2M5LTNlZWNkZmU2ODc1OCJ9&amp;pageName=ReportSection" class="uri">https://app.powerbi.com/view?r=eyJrIjoiNDc1ZjlkMGYtZWM3OC00MzQ4LTk1MmQtMzAxMDFkNDMwMDNlIiwidCI6IjM3MWYxZjdjLTA4OTQtNDFkMi04M2M5LTNlZWNkZmU2ODc1OCJ9&amp;pageName=ReportSection</a></p>
<iframe title="PowerBi NaiAlcantara" width="600" height="373.5" src="https://app.powerbi.com/view?r=eyJrIjoiNDc1ZjlkMGYtZWM3OC00MzQ4LTk1MmQtMzAxMDFkNDMwMDNlIiwidCI6IjM3MWYxZjdjLTA4OTQtNDFkMi04M2M5LTNlZWNkZmU2ODc1OCJ9&pageName=ReportSection" frameborder="0" allowFullScreen="true">
</iframe>
</section>
</body>
</html>
